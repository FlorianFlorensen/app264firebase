import React, {useEffect, useState} from 'react';
import "./login.css";
import childrenImage from './children.jpeg'
import {
    MDBAlert, MDBBtn, MDBCard, MDBCardBody, MDBCardText, MDBCardTitle, MDBCol, MDBInput, MDBRow
} from "mdb-react-ui-kit";
import {useAuthState} from "react-firebase-hooks/auth";
import {auth} from "../../firebase";
import {signInWithEmailAndPassword} from "firebase/auth";

function Login({setToken, setTokenToStorage}) {
    const [error, loading, user] = useAuthState(auth);

    const [username, setUsername] = useState();
    const [password, setPassword] = useState();


    //TODO blabla promise unhandled
    function login() {
        signInWithEmailAndPassword(auth, username, password)
    }

    useEffect(() => {
        console.log(error, loading, user);
    }, [error, loading, user]);


    //TODO: Error mesage on credentials and server down
    return (
        <div className="login">
            <section className="h-100 gradient-form" style={{'backgroundColor': '#eee'}}>
                <div className="container py-5 h-100">
                    <div className="row d-flex justify-content-center align-items-center h-100">
                        <div className="col-xl-10">
                            <MDBCard alignment="center" className="rounded-3 text-black">
                                <MDBRow className="g-0">
                                    <MDBCol lg="6">
                                        <MDBCardBody className="p-md-5 mx-md-4">
                                            <MDBCardTitle>
                                                <svg viewBox="0 0 455 50" xmlns="http://www.w3.org/2000/svg"
                                                     className="w-120 fill-current mt-1 mb-5 pb-1">
                                                    <path
                                                        d="M38.2088 48.2308V39.1596H16.6573C22.5627 35.5677 26.6416 32.8281 29.8074 30.0276C35.0431 25.3399 37.6 20.9565 37.6 15.3556C37.6 6.95412 31.8164 0.927002 19.8231 0.927002C6.6121 0.927002 0.402344 8.11084 0.402344 18.0343C0.402344 19.4345 0.524104 20.226 0.889384 21.8088H10.3867C10.0823 20.2868 9.83874 19.5563 9.83874 18.2169C9.83874 11.7028 14.283 8.90228 19.5187 8.90228C24.6326 8.90228 28.0419 11.4592 28.0419 15.7208C28.0419 19.1301 25.7893 22.3568 20.9189 26.3748C16.8399 29.6624 11.0563 33.4369 2.22874 39.1596V48.2308H38.2088ZM62.987 49.144C73.9454 49.144 81.3727 42.508 81.3727 32.3411C81.3727 23.2091 75.2239 16.9384 66.1527 16.9384C60.3691 16.9384 55.6814 19.5563 53.4288 23.5744C53.7941 14.3815 57.5687 8.41524 63.2914 8.41524C66.2745 8.41524 69.0141 10.059 69.8055 13.2856H79.1811C78.1461 5.73652 72.3625 0.987883 63.9611 0.987883C51.9068 0.987883 44.0533 11.7028 44.0533 26.8619C44.0533 40.6816 50.6283 49.144 62.987 49.144ZM62.8652 41.2904C57.6904 41.2904 54.2811 37.942 54.2811 32.8281C54.2811 27.7142 57.7513 24.3049 62.8652 24.3049C67.9791 24.3049 71.3884 27.7142 71.3884 32.8281C71.3884 38.0029 67.9183 41.2904 62.8652 41.2904ZM117.292 48.1699V39.5249H125.206V30.5147H117.292V20.4086H108.343V30.5147H97.5668L113.457 1.90108H103.229L87.2781 29.9059V39.5249H108.343V48.1699H117.292Z"/>
                                                    <path
                                                        d="M38.2088 48.2308V39.1596H16.6573C22.5627 35.5677 26.6416 32.8281 29.8074 30.0276C35.0431 25.3399 37.6 20.9565 37.6 15.3556C37.6 6.95412 31.8164 0.927002 19.8231 0.927002C6.6121 0.927002 0.402344 8.11084 0.402344 18.0343C0.402344 19.4345 0.524104 20.226 0.889384 21.8088H10.3867C10.0823 20.2868 9.83874 19.5563 9.83874 18.2169C9.83874 11.7028 14.283 8.90228 19.5187 8.90228C24.6326 8.90228 28.0419 11.4592 28.0419 15.7208C28.0419 19.1301 25.7893 22.3568 20.9189 26.3748C16.8399 29.6624 11.0563 33.4369 2.22874 39.1596V48.2308H38.2088ZM62.987 49.144C73.9454 49.144 81.3727 42.508 81.3727 32.3411C81.3727 23.2091 75.2239 16.9384 66.1527 16.9384C60.3691 16.9384 55.6814 19.5563 53.4288 23.5744C53.7941 14.3815 57.5687 8.41524 63.2914 8.41524C66.2745 8.41524 69.0141 10.059 69.8055 13.2856H79.1811C78.1461 5.73652 72.3625 0.987883 63.9611 0.987883C51.9068 0.987883 44.0533 11.7028 44.0533 26.8619C44.0533 40.6816 50.6283 49.144 62.987 49.144ZM62.8652 41.2904C57.6904 41.2904 54.2811 37.942 54.2811 32.8281C54.2811 27.7142 57.7513 24.3049 62.8652 24.3049C67.9791 24.3049 71.3884 27.7142 71.3884 32.8281C71.3884 38.0029 67.9183 41.2904 62.8652 41.2904ZM117.292 48.1699V39.5249H125.206V30.5147H117.292V20.4086H108.343V30.5147H97.5668L113.457 1.90108H103.229L87.2781 29.9059V39.5249H108.343V48.1699H117.292Z"/>
                                                    <path
                                                        d="M423 48.1699H428.11V30.3299C428.11 23.6999 433.78 19.8599 440.29 19.8599C446.56 19.8599 449.72 23.5099 449.72 29.1799V48.1799H454.84V27.8999C454.84 20.6499 449.54 15.2399 441.08 15.2399C436.94 15.2399 431.28 16.6299 428.08 21.0199V16.2099H423V48.1699ZM387.08 32.1599C387.08 24.8599 391.4 19.8599 399.93 19.8599C408.46 19.8599 412.77 24.9099 412.77 32.1599C412.77 39.4099 408.39 44.5199 399.93 44.5199C391.4 44.5199 387.08 39.4599 387.08 32.1599ZM418.05 32.1399C418.05 22.2799 410.8 15.2199 400.05 15.2199C389.3 15.2199 381.85 22.2799 381.85 32.1399C381.85 41.6399 389.27 49.1399 400.05 49.1399C410.76 49.1399 418.05 41.6599 418.05 32.1399ZM371.32 48.1399H376.43V16.1399H371.32V48.1399ZM370.89 7.5299H376.89V1.8999H370.89V7.5299ZM362.12 48.7499C362.31 48.7499 363.52 48.6899 365.17 48.5699V44.5199C363.89 44.5799 363.1 44.5799 362.61 44.5799C357.5 44.5799 356.1 43.3599 356.1 39.0999V20.5299H365.1V16.2099H356.1V7.9999H351.23V11.2899C351.23 15.1199 350.37 16.7699 345.56 16.7699V20.5399H351V39.9999C351 45.9099 353.8 48.8299 362.14 48.8299L362.12 48.7499ZM319.71 44.3799C313.71 44.3799 310.88 42.3799 310.88 39.2699C310.88 33.6099 319.95 32.6999 330.67 32.6999H333V37.6299C333 39.9999 328.56 44.3799 319.73 44.3799H319.71ZM319.55 48.8899C324.66 48.8899 330.87 46.6999 333.73 43.7699H333.79C334.4 46.9399 338.97 49.0099 342.93 48.7099H343V43.9999C339 44.1799 338.07 43.5099 338.07 40.4699V28.9299C338.07 18.2799 331.86 15.2999 323.33 15.2999C311.1 15.2999 308.05 21.0799 307.93 25.2199H313.05C313.23 22.7799 315.6 19.9199 323.27 19.9199C330.46 19.9199 332.83 22.7199 332.83 26.6799V28.5699H330.94C318.34 28.5699 313.29 29.7799 310.12 31.9199C307.32 33.7999 305.92 36.2399 305.92 39.0999C305.92 43.5399 308.97 48.8399 319.5 48.8399L319.55 48.8899ZM284.19 49.1399C294.72 49.1399 299.71 43.2399 300.51 38.1399H295.39C294.17 41.5499 290.39 44.5399 284.13 44.5399C275.48 44.5399 271.47 39.4199 271.47 32.1799C271.47 24.9399 275.55 19.8799 284.13 19.8799C290.4 19.8799 294.23 22.1899 295.45 27.3099H300.57C300.02 20.0599 293.63 15.3099 284.13 15.3099C272.62 15.3099 266.23 22.3099 266.23 32.2299C266.23 41.7299 272.32 49.2299 284.23 49.2299L284.19 49.1399ZM244.05 49.2299C249.35 49.2299 254.34 47.6499 257.38 42.7799V48.2599H262.5V16.2599H257.38V33.9999C257.38 40.6899 251.96 44.5299 244.72 44.5299C240.28 44.5299 235.72 43.0699 235.72 35.8799V16.2099H230.61V35.7499C230.61 44.8799 235.61 49.1399 244 49.1399L244.05 49.2299ZM217.65 33.6199C217.65 40.1299 212.54 44.4599 204.81 44.4599C197.08 44.4599 191.81 39.5299 191.81 32.0399C191.81 24.7299 196.81 19.9199 204.59 19.9199C212.37 19.9199 217.59 23.9199 217.59 29.8499L217.65 33.6199ZM217.65 1.8999V20.6499C214.17 17.1926 209.466 15.2485 204.56 15.2399C193.79 15.2399 186.56 21.9899 186.56 32.0999C186.56 42.2099 193.56 49.0999 203.91 49.0999C209.39 49.0999 215.11 47.0299 217.85 44.0999V48.1799H222.73V1.8999H217.65ZM151.48 29.6599C151.48 22.8399 157.14 19.8599 163.48 19.8599C169.82 19.8599 175.23 22.7799 175.23 29.6599H151.48ZM164 49.1399C174.53 49.1399 179.52 43.2399 180.31 39.2199H175.2C173.98 41.4699 170.08 44.5199 163.88 44.5199C156.27 44.5199 152.13 40.4399 151.46 34.2299L180.37 34.1699V28.8099C180.37 20.7099 173.62 15.2399 163.69 15.2399C152.49 15.2399 146.04 22.2399 146.04 32.0999C146.04 41.7199 152.13 49.0999 164.04 49.0999L164 49.1399ZM133.84 48.0999H140.78V41.8999H133.84V48.0999Z"/>
                                                </svg>
                                            </MDBCardTitle>
                                            <MDBCardText>
                                                <span>Please login to your account</span>
                                                <div className="form-outline mb-4">
                                                    <MDBInput label='Username' id='username' type='text'
                                                              onChange={event => setUsername(event.target.value)}/>
                                                </div>
                                                <div className="form-outline mb-4">
                                                    <MDBInput label='Password' id='password' type='password'
                                                              onChange={event => setPassword(event.target.value)}/>
                                                </div>
                                                <div className="pt-1 pb-1">
                                                    <MDBBtn
                                                        onClick={login}
                                                        type="submit" className="mx-2"
                                                        color="dark">Login</MDBBtn>
                                                </div>
                                                {error &&
                                                    <MDBAlert show className='w-100 p-2 mt-3' color='danger'>
                                                        <span className="mb-0">Its wrong</span>
                                                    </MDBAlert>}
                                            </MDBCardText>
                                        </MDBCardBody>
                                    </MDBCol>
                                    <div className="col-lg-6 d-flex align-items-center gradient-custom-2">
                                        <div>
                                            <img className='childrenImage' src={childrenImage} alt=''/>
                                        </div>
                                    </div>
                                </MDBRow>
                            </MDBCard>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    );
}

export default Login;
